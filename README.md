dirty and ugly code but it works, right?
